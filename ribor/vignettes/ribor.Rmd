---
title: "ribor - R interface for .ribo files"
author: "Michael Geng"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ribor - R interface for .ribo files}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
```{r global_options, include=FALSE}
library(knitr)
opts_chunk$set(fig.align = "center", fig.height = 5, fig.width = 6)
```

## Introduction
This package is an R interface for .ribo files generated by the riboflow
pipeline. These .ribo files are HDF5 files, and they take advantage of the
portability and group hierarchy capabilities offered by HDF5. The package
offers a suite of reading functions and plotting functions for downstream
analysis.

Many of the functions use the "rhdf5" package which is an  interface for 
HDF5 in the **R** environment. This package makes use of data slicing, the act
of accessing only a small subset of data at a time without reading in the 
entire dataset, and this functionality allows for efficient memory usage.

## Installation of the ribor package 
As it stands, the ribor package lives in a public GitHub repository.
Installing the package requires 'devtools', a CRAN package that provides
a wide suite of development tools in the R environment. 

To install the package in RStudio, run the following lines of code.
```{r, eval = FALSE}
install.packages("devtools")
library("devtools")
install_github("ribosomeprofiling/ribor_alpha/ribor")
```

### Getting Started 

#### Generating a ribo object

To get started, we should generate a ribo object that not only provides 
information about the file but most importantly a handle to the .ribo file
of interest.

```{r createRibo}
library(ribor)
file.path <- system.file("extdata", "sample.ribo", package = "ribor")
#generates the 'ribo' class object 
sample <- ribo(file.path)
```

The returned 'ribo' object is a list that contains 11 items. **Do not modify
the values of the returned object.** Certain values in the 'ribo' object's list
are used by later functions, so manually changing these values can alter 
the correctness of the other functions in this package.

Once we have called ribo object, we can then inquire about the contents of the
.ribo file.

First, we may want to look at general file information about the file and each
of its experiments. For this purpose, there is a print function for the ribo object. 
To view some information about the ribo file, 
```{r}
sample
```

Additionally, we can formally type out the print() function for the same output.
```{r}
print(sample)
```

The above output provides information about the internal contents and datasets of each individual experiment as well as general information across all experiments. 


###Using the 'ribo' object 
At times, experiment names may be long and tedious to type, so we may want to keep a vector of the experiment names. This will allow the user to reference an experiment by its index in a vector and allow for easier subsetting in later function calls. 

```{r get_experiments}
exp <- get_experiments(sample)
exp
```

If we want a returned list of many of the previously printed attributes, then the function get_info() will return all of the attributes found in the root of the .ribo file as well as information on each of the experiments. 

```{r get_info}
#retrieves the experiments
get_info(ribo.object = sample)
```

Additionally, if we want to see the metadata of a given experiment, then we can use the get_metadata() function and specify the experiment of interest.

```{r get_metadata}
get_metadata(ribo.object = sample)

get_metadata(ribo.object = sample,
             "Hela_1")
```

If get_metadata() is not given an experiment name, then the get_metadata() function becomes similar to get_info(), but it will not contain the 'experiment.info' element.